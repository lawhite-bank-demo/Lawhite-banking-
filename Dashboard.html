<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>User Dashboard</title>

<style>
body{margin:0;font-family:Arial;background:#0b0f14;color:white;}
.header{text-align:center;padding:20px;}
.logo{width:60px;margin-bottom:6px;}
.info{color:#9aa4b2;}
.card{background:#151b23;margin:15px;padding:20px;border-radius:14px;text-align:center;}
.balance{font-size:32px;margin-top:10px;}
button{width:100%;padding:14px;margin-top:12px;border-radius:8px;border:none;background:#2dd4bf;font-weight:bold;}
.transfer{display:none;margin-top:10px;}
input{width:100%;padding:12px;margin-top:10px;border-radius:8px;border:none;}
.tx{background:#0f1720;padding:10px;margin-top:6px;border-radius:8px;text-align:left;}
</style>
</head>

<body>

<div class="header">
<img src="logo.png" class="logo">
<div id="welcome"></div>
<div class="info" id="acct"></div>
<div class="info" id="iban"></div>
<div class="info" id="swift"></div>
</div>

<div class="card">
<div>Balance</div>
<div class="balance" id="balance"></div>

<button onclick="toggle()">Send Money</button>
<button onclick="historyShow()">Transactions</button>

<div class="transfer" id="box">
<input id="recipient" placeholder="Recipient">
<input id="amt" type="number" placeholder="Amount (€)">
<input id="date" type="date">
<button onclick="send()">Transfer</button>
</div>

<div id="history"></div>

<button onclick="logout()">Logout</button>
</div>

<script>
const currentUser = localStorage.getItem("currentUser");
if(!currentUser) window.location.href="index.html";

let users = JSON.parse(localStorage.getItem("users")) || [];
const user = users.find(u=>u.username===currentUser);

welcome.innerText="Welcome, "+currentUser.charAt(0).toUpperCase()+currentUser.slice(1);
acct.innerText="Account: "+user.accountNumber;
iban.innerText="IBAN: "+user.iban;
swift.innerText="SWIFT: "+user.swift;

function money(n){ return "€"+Number(n).toLocaleString(); }
function update(){ balance.innerText=money(user.balance); }

function toggle(){ box.style.display = box.style.display==="block"?"none":"block"; }

function send(){
  const name=recipient.value;
  const amount=Number(amt.value);
  let d=date.value;

  if(amount>user.balance) return alert("Insufficient funds");
  if(!d) d=new Date().toLocaleString();

  user.balance-=amount;
  localStorage.setItem("users", JSON.stringify(users));

  let tx=JSON.parse(localStorage.getItem(currentUser+"_tx"))||[];
  tx.push({name,amount,d});
  localStorage.setItem(currentUser+"_tx", JSON.stringify(tx));

  update();
  alert("Transfer successful");
}

function historyShow(){
  history.innerHTML="";
  const tx=JSON.parse(localStorage.getItem(currentUser+"_tx"))||[];
  tx.slice().reverse().forEach(t=>{
    history.innerHTML+=`
    <div class="tx">
    €${t.amount} → ${t.name}<br>
    <small>${t.d}</small>
    </div>`;
  });
}

function logout(){ window.location.href="index.html"; }

update();
</script>
</body>
</html>
